<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .ui-dialog .ui-state-error {
            padding: .3em;
        }

        .validateTips {
            border: 1px solid transparent;
            padding: 0.3em;
        }
    </style>
    <title>anexo8-pag44-ej1</title>
</head>

<body>
    <!-- Utiliza jquery ui y jquery para: crear una página que muestre una tabla de contactos indicando DNI, Nombre y Telefono
que muestre por defecto el contacto “11111111A”, Administrador, 555-000-001.
Al final de la tabla debe mostrarse un botón “Añadir”, y a la derecha de cada contacto en la
tabla otro botón “Eliminar”:
Cuando el usuario pulse el botón “Añadir” debe mostrarse un cuadro de diálogo con un
formulario en el que el usuario introduzca el DNI, nombre y teléfono de un nuevo contacto. El
cuadro de diálogo debe mostrar un botón “OK” para confirmar el alta, y otro “Cancelar”:
Cuando el usuario pulsa el botón “OK” debe comprobarse que se haya introducido un valor en
las tres cajas de texto. De no ser así, debe teñirse de rojo la caja vacía y mostrar un mensaje
indicativo a su lado derecho:
Si el usuario ha introducido datos en todas las cajas de texto al pulsar el botón “OK” debe
cerrarse el cuadro de diálogo y añadir los datos del nuevo contacto a la tabla de la página
incluyendo el botón “Eliminar”.
Al pulsar el botón “Eliminar” de una fila, ésta debe eliminarse de la tabla solicitando antes una
confirmación mostrando el nombre y DNI del usuario.
Si el usuario responde “Aceptar” debe eliminarse los datos del contacto de la tabla. No utilizar modal.-->

    <script src="./jquery.js"></script>
    <script src="./jquery-3.6.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
    <link rel="stylesheet" href="./jquery-ui.css">


    <script>
        $(document).ready(function () {
            var dialog, form,
                dni = $("#dni"),
                nombre = $("#nombre"),
                telefono = $("#telefono"),
                allFields = $([]).add(dni).add(nombre).add(telefono),
                tips = $(".validateTips");

            function updateTips(t) {
                tips
                    .text(t)
                    .addClass("ui-state-highlight");
                setTimeout(function () {
                    tips.removeClass("ui-state-highlight", 1500);
                }, 500);
            }

            function checkLength(o, n, min, max) {
                if (o.val().length > max || o.val().length < min) {
                    o.addClass("ui-state-error");
                    updateTips("La longitud de " + n + " debe estar entre " +
                        min + " y " + max + ".");
                    return false;
                } else {
                    return true;
                }
            }

            function checkRegexp(o, regexp, n) {
                if (!(regexp.test(o.val()))) {
                    o.addClass("ui-state-error");
                    updateTips(n);
                    return false;
                } else {
                    return true;
                }
            }

            function addUser() {
                var valid = true;
                allFields.removeClass("ui-state-error");

                valid = valid && checkLength(dni, "DNI", 8, 12);
                valid = valid && checkLength(nombre, "nombre", 3, 50);
                valid = valid && checkLength(telefono, "telefono", 8, 20);

                valid = valid && checkRegexp(dni, /^[0-9a-zA-Z]+$/, "El DNI debe contener solo letras y números.");
                valid = valid && checkRegexp(nombre, /^[a-z]([0-9a-z_\s])+$/i, "El nombre debe contener solo letras, números, espacios y guiones bajos.");
                valid = valid && checkRegexp(telefono, /^[0-9]+$/, "El telefono debe contener solo números.");

                if (valid) {
                    $("#users tbody").append("<tr>" +
                        "<td>" + dni.val() + "</td>" +
                        "<td>" + nombre.val() + "</td>" +
                        "<td>" + telefono.val() + "</td>" +
                        "<td><button class='eliminar'>Eliminar</button></td>" +
                        "</tr>");
                    dialog.dialog("close");
                }
                return valid;
            }

            dialog = $("#dialog-form").dialog({
                autoOpen: false,
                height: 400,
                width: 350,
                modal: true,
                buttons: {
                    "Añadir": addUser,
                    Cancelar: function () {
                        dialog.dialog("close");
                    }
                },
                close: function () {
                    // Eliminar la fila del boton seleccionado con jquery
                    $(document).on('click', '.borrar', function (event) {
                        $(this).closest('tr').remove();
                    });
                    allFields.removeClass("ui-state-error");
                }
            });

            $(document).ready(function () {
                $("#create-user").button().on("click", function () {
                    $("#dialog-form").dialog("open");
                });
            });

            $(document).ready(function () {
                $(".eliminar").click(function () {
                    $(this).closest("tr").remove();
                });
            });
        });
    </script>

    <!--
table: Utiliza jquery ui y jquery para: crear una página que muestre una tabla de contactos indicando DNI, Nombre y Telefono
que muestre por defecto el contacto “11111111A”, Administrador, 555-000-001.
Al final de la tabla debe mostrarse un botón “Añadir”, y a la derecha de cada contacto en la
tabla otro botón “Eliminar”: -->

    <div id="dialog-form" title="Añadir contacto">
        <p class="validateTips">Todos los campos son obligatorios.</p>

        <form>
            <fieldset>
                <label for="dni">DNI</label>
                <input type="text" name="dni" id="dni" value="" class="text ui-widget-content ui-corner-all">
                <label for="nombre">Nombre</label>
                <input type="text" name="nombre" id="nombre" value="" class="text ui-widget-content ui-corner-all">
                <label for="telefono">Telefono</label>
                <input type="text" name="telefono" id="telefono" value="" class="text ui-widget-content ui-corner-all">
            </fieldset>
        </form>
    </div>

    <table id="users" border="1">
        <thead>
            <tr>
                <th>DNI</th>
                <th>Nombre</th>
                <th>Telefono</th>
                <th>Eliminar</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>11111111A</td>
                <td>Administrador</td>
                <td>555-000-001</td>
                <td><button class="eliminar">Eliminar</button></td>
            </tr>
            <tr>
                <td>22222222B</td>
                <td>Usuario</td>
                <td>555-000-002</td>
                <td><button class="eliminar">Eliminar</button></td>
            </tr>
        </tbody>
    </table>
    <button id="create-user">Añadir</button>
    </tr>
    </tbody>
    </table>

    <button id="create-user">Añadir</button>

</body>

</html>